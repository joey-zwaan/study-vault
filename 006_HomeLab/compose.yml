name: monitoring infrastructure

services:

  uptime-kuma:
    container_name: uptime-kuma
    image: louislam/uptime-kuma:debian
    restart: unless-stopped
    environment:
      VIRTUAL_HOST: "status.joey-home.com"
      LETSENCRYPT_HOST: "status.joey-home.com"
      VIRTUAL_PORT: "3001"
#    ports:
#      - 3001:3001
    networks:
      - plex-stack
    volumes:
      - uptime-kuma:/app/data
      - /var/run/docker.sock:/var/run/docker.sock ## Nodig voor container monitoring


  homarr:
    container_name: homarr
    image: ghcr.io/homarr-labs/homarr:latest
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock # Optional, only if you want docker integration
      - homarr:/appdata
    environment:
      SECRET_ENCRYPTION_KEY: 874c2740aff027134136cc0f6663c831f2765b7eeb759d97e97e7d07eee8bcae
#      BASE_URL: "https://start.joey-home.com"
      VIRTUAL_HOST: "start.joey-home.com"
      LETSENCRYPT_HOST: "start.joey-home.com"
      VIRTUAL_PORT: "7575"
    networks:
      plex-stack:
        ipv4_address: 172.18.11.55

  nginx-proxy:
    container_name: nginx-proxy
    image: nginxproxy/nginx-proxy:1.9.0
    restart: unless-stopped
    environment:
      TZ: CEST
      ENABLE_IPV6: true
#      PREFER_IPV6_NETWORK: true
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - certs:/etc/nginx/certs
      - html:/usr/share/nginx/html
      - /var/run/docker.sock:/tmp/docker.sock:ro ## Maakt communicatie met de Docker daemon mogelijk
    networks:
      - plex-stack

  nginx-proxy-acme:
    image: nginxproxy/acme-companion:2.6
    restart: unless-stopped
    depends_on:
      - nginx-proxy
    environment:
      NGINX_PROXY_CONTAINER: nginx-proxy
      DEFAULT_EMAIL: monitoring@joey-home.com
    volumes:
      - certs:/etc/nginx/certs
      - html:/usr/share/nginx/html
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - acme:/etc/acme.sh
    networks:
      - plex-stack

  qbittorrent:
    image: ghcr.io/linuxserver/qbittorrent
    container_name: qbittorrent
    environment:
      TZ: CEST
      WEBUI_PORT: "8085"
      VIRTUAL_HOST: "qbit.joey-home.com"
      LETSENCRYPT_HOST: "qbit.joey-home.com"
      VIRTUAL_PORT: "8085"
    volumes:
      - /mnt/plex-stack/config-containers/qbittorrent/config:/config
      - /mnt/plex-stack/media/downloads:/downloads
    restart: unless-stopped
    networks:
      plex-stack:
        ipv4_address: 172.18.11.20

  sonarr:
    image: ghcr.io/linuxserver/sonarr:latest
    container_name: sonarr
    environment:
      TZ: CEST
      VIRTUAL_HOST: "sonarr.joey-home.com"
      LETSENCRYPT_HOST: "sonarr.joey-home.com"
      VIRTUAL_PORT: "8989"
    volumes:
      - /mnt/plex-stack/config-containers/sonarr/config:/config
      - /mnt/plex-stack/media/tv-shows:/tv
      - /mnt/plex-stack/media/downloads:/downloads
    restart: unless-stopped
    networks:
      plex-stack:
        ipv4_address: 172.18.11.10

  radarr:
    image: ghcr.io/linuxserver/radarr:latest
    container_name: radarr
    environment:
      TZ: CEST
      VIRTUAL_HOST: "radarr.joey-home.com"
      LETSENCRYPT_HOST: "radarr.joey-home.com"
      VIRTUAL_PORT: "7878"

    volumes:
      - /mnt/plex-stack/config-containers/radarr/config:/config
      - /mnt/plex-stack/media/movies:/movies
      - /mnt/plex-stack/media/downloads:/downloads
    restart: unless-stopped
    networks:
      plex-stack:
        ipv4_address: 172.18.11.8

  prowlarr:
    image: lscr.io/linuxserver/prowlarr:latest
    container_name: prowlarr
    ports:
      - "9696:9696"
    environment:
      - TZ=CEST
    volumes:
      - /mnt/plex-stack/config-containers/prowlarr/config:/config
    restart: unless-stopped
    networks:
      plex-stack:
        ipv4_address: 172.18.11.21


  unpackerr:
    image: golift/unpackerr
    container_name: unpackerr
#    ports:
 #     - "5656:5656"
    volumes:
      - /mnt/plex-stack/media/downloads:/downloads
    restart: always
    user: 1000:100
    environment:
      - TZ=CEST
      - UN_LOG_FILE=/downloads/unpackerr.log
      - UN_SONARR_0_URL=https://sonarr.joey-home.com
      - UN_SONARR_0_API_KEY=572cb4b84b5d4162ac8ddb19328dc867
      - UN_RADARR_0_URL=https://radarr.joey-home.com
      - UN_RADARR_0_API_KEY=0aa7f080ac8844388c451fac46d39abf
      - UN_DELAY=300
    networks:
      - plex-stack


  sabnzbd:
    image: lscr.io/linuxserver/sabnzbd:latest
    container_name: sabnzbd
    environment:
      TZ: CEST
      VIRTUAL_HOST: "sab.joey-home.com"
      LETSENCRYPT_HOST: "sab.joey-home.com"
      VIRTUAL_PORT: "8080"
    volumes:
      - /mnt/plex-stack/config-containers/sabnzbd:/config
      - /mnt/plex-stack/media/downloads:/downloads #optional
      - /mnt/plex-stack/media/downloads/incomplete:/incomplete-downloads #optional
    restart: unless-stopped
    networks:
      plex-stack:
        ipv4_address: 172.18.11.22


  plex:
    image: lscr.io/linuxserver/plex:latest
    container_name: plex
    ports:
      - "32400:32400"
    environment:
      TZ: CEST
      VERSION: docker
      VIRTUAL_HOST: "plex.joey-home.com"
      LETSENCRYPT_HOST: "plex.joey-home.com"
      VIRTUAL_PORT: "32400"
#      PLEX_CLAIM: claim-xsYXPceRgbos3SgCA5Ta #optional
#      ADVERTISE_IP: 192.168.20.11
    volumes:
      - plex-config:/config
      - /mnt/plex-stack/media/tv-shows:/tv
      - /mnt/plex-stack/media/movies:/movies
    restart: unless-stopped
    networks:
      plex-stack:
        ipv4_address: 172.18.11.50

  jellyseerr:
    image: ghcr.io/fallenbagel/jellyseerr:latest
    container_name: jellyseerr
#     init: true
    environment:
      LOG_LEVEL: info
      TZ: CEST
      VIRTUAL_HOST: "request.joey-home.com"
      LETSENCRYPT_HOST: "request.joey-home.com"
      VIRTUAL_PORT: "5055"
    volumes:
      - seer:/app/config
    restart: unless-stopped
    networks:
      - plex-stack



volumes:
  uptime-kuma:
  homepage:
  certs:
  acme:
  html:
  plex-config:
  seer:
  homarr:

networks:
  plex-stack:
    driver: bridge
    enable_ipv4: true
    enable_ipv6: true
    ipam:
      driver: default
      config:
        - subnet: 172.18.11.0/24
          ip_range: 172.18.11.0/24
          gateway: 172.18.11.1
        - subnet: fd00:11::/64